// Code generated by qtc from "queries.qtpl". DO NOT EDIT.
// See https://github.com/valyala/quicktemplate for details.

//line queries.qtpl:1
package templates

//line queries.qtpl:1
import (
	qtio422016 "io"

	qt422016 "github.com/valyala/quicktemplate"
)

//line queries.qtpl:1
var (
	_ = qtio422016.Copy
	_ = qt422016.AcquireByteBuffer
)

//line queries.qtpl:1
func StreamQueries(qw422016 *qt422016.Writer, input *QueriesInput) {
//line queries.qtpl:1
	qw422016.N().S(`
// Code generated by ormgen; DO NOT EDIT.

package `)
//line queries.qtpl:4
	qw422016.E().S(input.Package.Name)
//line queries.qtpl:4
	qw422016.N().S(`

import (
	"github.com/setare/orm"
	sq "github.com/Masterminds/squirrel"
	"context"
	"github.com/pkg/errors"

`)
//line queries.qtpl:12
	if !input.ModelsPackage.Equals(input.Package) {
//line queries.qtpl:12
		qw422016.N().S(`
	"`)
//line queries.qtpl:13
		qw422016.E().S(input.ModelsPackage.ImportPath)
//line queries.qtpl:13
		qw422016.N().S(`"
`)
//line queries.qtpl:14
	}
//line queries.qtpl:14
	qw422016.N().S(`
)

`)
//line queries.qtpl:17
	for _, record := range input.Records {
//line queries.qtpl:17
		qw422016.N().S(`type `)
//line queries.qtpl:18
		qw422016.E().S(record.Query.Type)
//line queries.qtpl:18
		qw422016.N().S(` struct {
	Conn orm.Connection
	baseQuery orm.Query
}

func New`)
//line queries.qtpl:23
		qw422016.E().S(record.Query.Type)
//line queries.qtpl:23
		qw422016.N().S(`(conn orm.Connection) (*`)
//line queries.qtpl:23
		qw422016.E().S(record.Query.Type)
//line queries.qtpl:23
		qw422016.N().S(`, error) {
	qry := &`)
//line queries.qtpl:24
		qw422016.E().S(record.Query.Type)
//line queries.qtpl:24
		qw422016.N().S(`{
		Conn: conn,
		baseQuery: orm.NewQuery(`)
//line queries.qtpl:26
		qw422016.E().S(record.Schema.InternalRef)
//line queries.qtpl:26
		qw422016.N().S(`),
	}
	ds, ok := interface{}(qry).(orm.DefaultScoper)
	if !ok {
		return qry, nil
	}
	err := ds.DefaultScope()
	if err != nil {
		return nil, err
	}
	return qry, nil
}

func (query *`)
//line queries.qtpl:39
		qw422016.E().S(record.Query.Type)
//line queries.qtpl:39
		qw422016.N().S(`) Select(fields ...orm.SchemaField) *`)
//line queries.qtpl:39
		qw422016.E().S(record.Query.Type)
//line queries.qtpl:39
		qw422016.N().S(` {
	query.baseQuery.Select(fields...)
	return query
}

func (query *`)
//line queries.qtpl:44
		qw422016.E().S(record.Query.Type)
//line queries.qtpl:44
		qw422016.N().S(`) AddSelect(fields ...orm.SchemaField) *`)
//line queries.qtpl:44
		qw422016.E().S(record.Query.Type)
//line queries.qtpl:44
		qw422016.N().S(` {
	query.baseQuery.AddSelect(fields...)
	return query
}

func (query *`)
//line queries.qtpl:49
		qw422016.E().S(record.Query.Type)
//line queries.qtpl:49
		qw422016.N().S(`) From(schema orm.Schema) *`)
//line queries.qtpl:49
		qw422016.E().S(record.Query.Type)
//line queries.qtpl:49
		qw422016.N().S(` {
	query.baseQuery.From(schema)
	return query
}

func (query *`)
//line queries.qtpl:54
		qw422016.E().S(record.Query.Type)
//line queries.qtpl:54
		qw422016.N().S(`) Join(joinType orm.JoinType, schema orm.Schema, conditions ...sq.Sqlizer) *`)
//line queries.qtpl:54
		qw422016.E().S(record.Query.Type)
//line queries.qtpl:54
		qw422016.N().S(` {
	query.baseQuery.Join(joinType, schema, conditions...)
	return query
}

func (query *`)
//line queries.qtpl:59
		qw422016.E().S(record.Query.Type)
//line queries.qtpl:59
		qw422016.N().S(`) InnerJoin(schema orm.Schema, conditions ...sq.Sqlizer) *`)
//line queries.qtpl:59
		qw422016.E().S(record.Query.Type)
//line queries.qtpl:59
		qw422016.N().S(` {
	query.baseQuery.InnerJoin(schema, conditions...)
	return query
}

func (query *`)
//line queries.qtpl:64
		qw422016.E().S(record.Query.Type)
//line queries.qtpl:64
		qw422016.N().S(`) LeftJoin(schema orm.Schema, conditions ...sq.Sqlizer) *`)
//line queries.qtpl:64
		qw422016.E().S(record.Query.Type)
//line queries.qtpl:64
		qw422016.N().S(` {
	query.baseQuery.LeftJoin(schema, conditions...)
	return query
}

func (query *`)
//line queries.qtpl:69
		qw422016.E().S(record.Query.Type)
//line queries.qtpl:69
		qw422016.N().S(`) RightJoin(schema orm.Schema, conditions ...sq.Sqlizer) *`)
//line queries.qtpl:69
		qw422016.E().S(record.Query.Type)
//line queries.qtpl:69
		qw422016.N().S(` {
	query.baseQuery.RightJoin(schema, conditions...)
	return query
}

func (query *`)
//line queries.qtpl:74
		qw422016.E().S(record.Query.Type)
//line queries.qtpl:74
		qw422016.N().S(`) FullJoin(schema orm.Schema, conditions ...sq.Sqlizer) *`)
//line queries.qtpl:74
		qw422016.E().S(record.Query.Type)
//line queries.qtpl:74
		qw422016.N().S(` {
	query.baseQuery.FullJoin(schema, conditions...)
	return query
}

func (query *`)
//line queries.qtpl:79
		qw422016.E().S(record.Query.Type)
//line queries.qtpl:79
		qw422016.N().S(`) Where(conditions ...sq.Sqlizer) *`)
//line queries.qtpl:79
		qw422016.E().S(record.Query.Type)
//line queries.qtpl:79
		qw422016.N().S(` {
	query.baseQuery.Where(conditions...)
	return query
}

func (query *`)
//line queries.qtpl:84
		qw422016.E().S(record.Query.Type)
//line queries.qtpl:84
		qw422016.N().S(`) Skip(skip int) *`)
//line queries.qtpl:84
		qw422016.E().S(record.Query.Type)
//line queries.qtpl:84
		qw422016.N().S(` {
	query.baseQuery.Skip(skip)
	return query
}

func (query *`)
//line queries.qtpl:89
		qw422016.E().S(record.Query.Type)
//line queries.qtpl:89
		qw422016.N().S(`) Limit(limit int) *`)
//line queries.qtpl:89
		qw422016.E().S(record.Query.Type)
//line queries.qtpl:89
		qw422016.N().S(` {
	query.baseQuery.Limit(limit)
	return query
}

func (query *`)
//line queries.qtpl:94
		qw422016.E().S(record.Query.Type)
//line queries.qtpl:94
		qw422016.N().S(`) GroupBy(fields ...orm.SchemaField) *`)
//line queries.qtpl:94
		qw422016.E().S(record.Query.Type)
//line queries.qtpl:94
		qw422016.N().S(` {
	query.baseQuery.GroupBy(fields...)
	return query
}

func (query *`)
//line queries.qtpl:99
		qw422016.E().S(record.Query.Type)
//line queries.qtpl:99
		qw422016.N().S(`) GroupByHaving(fields []orm.SchemaField, conditions ...sq.Sqlizer) *`)
//line queries.qtpl:99
		qw422016.E().S(record.Query.Type)
//line queries.qtpl:99
		qw422016.N().S(` {
	query.baseQuery.GroupByHaving(fields, conditions...)
	return query
}

func (query *`)
//line queries.qtpl:104
		qw422016.E().S(record.Query.Type)
//line queries.qtpl:104
		qw422016.N().S(`) OrderBy(fields ...orm.SchemaField) *`)
//line queries.qtpl:104
		qw422016.E().S(record.Query.Type)
//line queries.qtpl:104
		qw422016.N().S(` {
	query.baseQuery.OrderBy(fields...)
	return query
}

func (query *`)
//line queries.qtpl:109
		qw422016.E().S(record.Query.Type)
//line queries.qtpl:109
		qw422016.N().S(`) One() (*`)
//line queries.qtpl:109
		qw422016.E().S(input.ModelsPackage.Ref(input.Package, record.Name))
//line queries.qtpl:109
		qw422016.N().S(`, error) {
	return query.OneContext(context.Background())
}

func (query *`)
//line queries.qtpl:113
		qw422016.E().S(record.Query.Type)
//line queries.qtpl:113
		qw422016.N().S(`) OneContext(ctx context.Context) (*`)
//line queries.qtpl:113
		qw422016.E().S(input.ModelsPackage.Ref(input.Package, record.Name))
//line queries.qtpl:113
		qw422016.N().S(`, error) {
	record := &`)
//line queries.qtpl:114
		qw422016.E().S(input.ModelsPackage.Ref(input.Package, record.Name))
//line queries.qtpl:114
		qw422016.N().S(`{}
	err := query.OnePContext(ctx, record)
	if err != nil {
		return nil, err
	}
	return record, nil
}

func (query *`)
//line queries.qtpl:122
		qw422016.E().S(record.Query.Type)
//line queries.qtpl:122
		qw422016.N().S(`) OneP(record *`)
//line queries.qtpl:122
		qw422016.E().S(input.ModelsPackage.Ref(input.Package, record.Name))
//line queries.qtpl:122
		qw422016.N().S(`) error {
	return query.OnePContext(context.Background(), record)
}

func (query *`)
//line queries.qtpl:126
		qw422016.E().S(record.Query.Type)
//line queries.qtpl:126
		qw422016.N().S(`) OnePContext(ctx context.Context, record *`)
//line queries.qtpl:126
		qw422016.E().S(input.ModelsPackage.Ref(input.Package, record.Name))
//line queries.qtpl:126
		qw422016.N().S(`) error {
	sql, args, err := query.baseQuery.ToSql()
	if err != nil {
		return err
	}
	fields := query.baseQuery.GetSelect()
	if len(fields) == 0 {
		fields = `)
//line queries.qtpl:133
		qw422016.E().S(record.Schema.InternalRef)
//line queries.qtpl:133
		qw422016.N().S(`Fields
	}
	columnValues := make([]interface{}, len(fields))
	for i, field := range fields {
		var fieldAddr interface{}
		`)
//line queries.qtpl:138
		StreamColumnAddresses(qw422016, &ColumnAddressesInput{
			FieldName:  "field.Name()",
			TargetName: "fieldAddr",
			RecordName: "record",
			ErrName:    "err",
			Record:     record,
		})
//line queries.qtpl:144
		qw422016.N().S(`
		if err != nil {
			return err
		}
		columnValues[i] = fieldAddr
	}
	return query.Conn.QueryRowContext(ctx, sql, args...).Scan(columnValues...)
}

func (query *`)
//line queries.qtpl:153
		qw422016.E().S(record.Query.Type)
//line queries.qtpl:153
		qw422016.N().S(`) All() (*`)
//line queries.qtpl:153
		qw422016.E().S(record.ResultSet.Type)
//line queries.qtpl:153
		qw422016.N().S(`, error) {
	return query.AllContext(context.Background())
}

func (query *`)
//line queries.qtpl:157
		qw422016.E().S(record.Query.Type)
//line queries.qtpl:157
		qw422016.N().S(`) AllContext(ctx context.Context) (*`)
//line queries.qtpl:157
		qw422016.E().S(record.ResultSet.Type)
//line queries.qtpl:157
		qw422016.N().S(`, error) {
	sql, args, err := query.baseQuery.ToSql()
	if err != nil {
		return nil, err
	}
	rs, err := query.Conn.QueryContext(ctx, sql, args...)
	if err != nil {
		return nil, err
	}
	return New`)
//line queries.qtpl:166
		qw422016.E().S(record.ResultSet.Type)
//line queries.qtpl:166
		qw422016.N().S(`(rs)
}

`)
//line queries.qtpl:169
	}
//line queries.qtpl:170
}

//line queries.qtpl:170
func WriteQueries(qq422016 qtio422016.Writer, input *QueriesInput) {
//line queries.qtpl:170
	qw422016 := qt422016.AcquireWriter(qq422016)
//line queries.qtpl:170
	StreamQueries(qw422016, input)
//line queries.qtpl:170
	qt422016.ReleaseWriter(qw422016)
//line queries.qtpl:170
}

//line queries.qtpl:170
func Queries(input *QueriesInput) string {
//line queries.qtpl:170
	qb422016 := qt422016.AcquireByteBuffer()
//line queries.qtpl:170
	WriteQueries(qb422016, input)
//line queries.qtpl:170
	qs422016 := string(qb422016.B)
//line queries.qtpl:170
	qt422016.ReleaseByteBuffer(qb422016)
//line queries.qtpl:170
	return qs422016
//line queries.qtpl:170
}
